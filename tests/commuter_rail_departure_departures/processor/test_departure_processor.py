from datetime import datetime
import pytest
import pytz
from freezegun import freeze_time

from commuter_rail_departure_departures.models import Stop, Route
from commuter_rail_departure_departures.processor.departure_processor import DepartureProcessor


@pytest.mark.django_db
class TestDepartureProcessor:
    
    def test_processor_gets_good_data(self, mock_mbta_client):
        Stop.stops.create_from_mbta_client()
        Route.routes.create_from_mbta_client()
        stop = Stop.objects.get(mbta_id="place-sstat")
        moved_time = "2024-02-06 06:44:00"
        eastern = pytz.timezone('US/Eastern')
        moved_time_dt = eastern.localize(datetime.strptime(moved_time, "%Y-%m-%d %H:%M:%S"))
        expected_data = "[{'carrier': 'MBTA', 'departure_time': '2024-02-07 04:20:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 04:45:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 05:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 05:30:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 05:45:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 06:15:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 06:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': '1848', 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 06:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 06:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 06:38:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': '1841', 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 06:50:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 07:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 07:10:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': '1846', 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 07:10:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': '1840', 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 07:20:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': '1801', 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 07:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': '1808', 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 07:30:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': '1837', 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 07:30:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': '1839', 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 07:40:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 07:50:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 07:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 07:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 08:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 08:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 08:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 08:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 08:40:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 08:45:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 08:48:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 08:50:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 08:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 08:57:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 09:12:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 09:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 09:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 09:33:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 09:35:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 09:50:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 09:50:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 10:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 10:02:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 10:10:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 10:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 10:30:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 10:35:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 10:48:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 10:50:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 10:50:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 10:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 11:15:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 11:15:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 11:28:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 11:40:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 11:45:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 11:45:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 11:50:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 12:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 12:03:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 12:20:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 12:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 12:30:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 12:30:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 12:50:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 12:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 13:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 13:05:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 13:10:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 13:18:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 13:20:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 13:30:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 13:45:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 13:45:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 13:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 13:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 14:05:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 14:15:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 14:20:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 14:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 14:33:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 14:40:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 14:40:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 14:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 14:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 15:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 15:15:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 15:20:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 15:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 15:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 15:30:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 15:33:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 15:52:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 15:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 16:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 16:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 16:05:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 16:05:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 16:10:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 16:10:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 16:15:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 16:20:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 16:27:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 16:33:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 16:45:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 16:52:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 16:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 16:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 16:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 17:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 17:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 17:05:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 17:15:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 17:30:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 17:32:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 17:33:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 17:40:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 17:40:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 17:45:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 17:50:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 17:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 17:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 18:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 18:15:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 18:22:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 18:23:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 18:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 18:35:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 18:35:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 18:45:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 18:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 19:05:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 19:05:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 19:10:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 19:20:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 19:35:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 19:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 19:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 20:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 20:10:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 20:15:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 20:35:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 20:35:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 20:40:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 20:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 21:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 21:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 21:20:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 21:25:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 21:30:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 21:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 22:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 22:10:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 22:15:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 22:30:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 22:45:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 23:00:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 23:20:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 23:45:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 23:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 23:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}, {'carrier': 'MBTA', 'departure_time': '2024-02-07 23:55:00-05:00', 'arrival_time': None, 'destination': None, 'vehicle_id': None, 'status': 'ON-TIME', 'has_prediction': False}]"
        with freeze_time(moved_time_dt) as freezer:
            eastern_time = datetime.now(eastern)
            data = DepartureProcessor.process_data(stop.mbta_id, eastern_time)
        assert str(data) == expected_data